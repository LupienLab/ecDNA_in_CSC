library(org.Hs.eg.db)
library(TxDb.Hsapiens.UCSC.hg38.knownGene)
library(BSgenome.Hsapiens.UCSC.hg38)
#--- loci of interest - MYCN: chr2: 13071799 - 18831798
id = "G523"
chr = "chr7"
start = 52615323
end = 57235322
res = 5000
arc <- fread(paste0("/Users/cpan/Documents/ChIP/", id, "/enriched_pixels_", res, ".bedpe")) %>% dplyr::select(chr1, x1, x2, chr2, y1, y2) %>%
{colnames(.) = c("chrom1", "start1", "end1", "chrom2", "start2", "end2");.} %>%
mutate(chrom1 = paste0("chr", chrom1), chrom2 = paste0("chr", chrom2))
pdf(paste0("./outputs/", id, "_EGFR_", res, ".pdf"), width = 6, height = 4) # width = 6
pageCreate(width = 5, height = 5, default.units = "inches", showGuides = F, xgrid = 0, ygrid = 0)
plotPairsArches(
data = arc,
chrom = chr, chromstart = start, chromend = end,
assembly = "hg38",
x = 0.5, y = 2.5, width = 4, height = 0.25,
just = c("left", "top"), default.units = "inches",
fill = "black", linecolor = "black", flip = TRUE
)
plotGenes(
chrom = chr, chromstart = start, chromend = end,
assembly = "hg38",
fontsize = 8,
x = 0.5, y = 3.05, width = 4, height = 0.5,
fontcolor = c("blue", "blue"),
fill = c("black", "black"),
strandLabels = TRUE,
stroke = 0.01,
just = c("left", "top"), default.units = "inches"
)
dev.off()
rm(list = ls())
library(grid)
library(tidyr)
library(dplyr)
library(data.table)
library(plotgardener)
library(org.Hs.eg.db)
library(TxDb.Hsapiens.UCSC.hg38.knownGene)
library(BSgenome.Hsapiens.UCSC.hg38)
#--- loci of interest - MYCN: chr2: 13071799 - 18831798
id = "G523"
chr = "chr7"
start = 52615323
end = 57235322
res = 10000
arc <- fread(paste0("/Users/cpan/Documents/ChIP/", id, "/enriched_pixels_", res, ".bedpe")) %>% dplyr::select(chr1, x1, x2, chr2, y1, y2) %>%
{colnames(.) = c("chrom1", "start1", "end1", "chrom2", "start2", "end2");.} %>%
mutate(chrom1 = paste0("chr", chrom1), chrom2 = paste0("chr", chrom2))
pdf(paste0("./outputs/", id, "_EGFR_", res, ".pdf"), width = 6, height = 4) # width = 6
pageCreate(width = 5, height = 5, default.units = "inches", showGuides = F, xgrid = 0, ygrid = 0)
plotPairsArches(
data = arc,
chrom = chr, chromstart = start, chromend = end,
assembly = "hg38",
x = 0.5, y = 2.5, width = 4, height = 0.25,
just = c("left", "top"), default.units = "inches",
fill = "black", linecolor = "black", flip = TRUE
)
plotGenes(
chrom = chr, chromstart = start, chromend = end,
assembly = "hg38",
fontsize = 8,
x = 0.5, y = 3.05, width = 4, height = 0.5,
fontcolor = c("blue", "blue"),
fill = c("black", "black"),
strandLabels = TRUE,
stroke = 0.01,
just = c("left", "top"), default.units = "inches"
)
dev.off()
rm(list = ls())
library(grid)
library(tidyr)
library(dplyr)
library(data.table)
library(plotgardener)
library(org.Hs.eg.db)
library(TxDb.Hsapiens.UCSC.hg38.knownGene)
library(BSgenome.Hsapiens.UCSC.hg38)
#--- loci of interest - MYCN: chr2: 13071799 - 18831798
id = "G583"
chr = "chr7"
start = 52615323
end = 57235322
res = 10000
arc <- fread(paste0("/Users/cpan/Documents/ChIP/", id, "/enriched_pixels_", res, ".bedpe")) %>% dplyr::select(chr1, x1, x2, chr2, y1, y2) %>%
{colnames(.) = c("chrom1", "start1", "end1", "chrom2", "start2", "end2");.} %>%
mutate(chrom1 = paste0("chr", chrom1), chrom2 = paste0("chr", chrom2))
pdf(paste0("./outputs/", id, "_EGFR_", res, ".pdf"), width = 6, height = 4) # width = 6
pageCreate(width = 5, height = 5, default.units = "inches", showGuides = F, xgrid = 0, ygrid = 0)
plotPairsArches(
data = arc,
chrom = chr, chromstart = start, chromend = end,
assembly = "hg38",
x = 0.5, y = 2.5, width = 4, height = 0.25,
just = c("left", "top"), default.units = "inches",
fill = "black", linecolor = "black", flip = TRUE
)
plotGenes(
chrom = chr, chromstart = start, chromend = end,
assembly = "hg38",
fontsize = 8,
x = 0.5, y = 3.05, width = 4, height = 0.5,
fontcolor = c("blue", "blue"),
fill = c("black", "black"),
strandLabels = TRUE,
stroke = 0.01,
just = c("left", "top"), default.units = "inches"
)
dev.off()
rm(list = ls())
library(grid)
library(tidyr)
library(dplyr)
library(data.table)
library(plotgardener)
library(org.Hs.eg.db)
library(TxDb.Hsapiens.UCSC.hg38.knownGene)
library(BSgenome.Hsapiens.UCSC.hg38)
#--- loci of interest - MYCN: chr2: 13071799 - 18831798
id = "G583"
chr = "chr2"
start = 13071799
end = 18831798
res = 5000
arc <- fread(paste0("/Users/cpan/Documents/ChIP/", id, "/enriched_pixels_", res, ".bedpe")) %>% dplyr::select(chr1, x1, x2, chr2, y1, y2) %>%
{colnames(.) = c("chrom1", "start1", "end1", "chrom2", "start2", "end2");.} %>%
mutate(chrom1 = paste0("chr", chrom1), chrom2 = paste0("chr", chrom2))
pdf(paste0("./outputs/", id, "_MYCN", res, ".pdf"), width = 6, height = 4) # width = 6
pageCreate(width = 5, height = 5, default.units = "inches", showGuides = F, xgrid = 0, ygrid = 0)
plotPairsArches(
data = arc,
chrom = chr, chromstart = start, chromend = end,
assembly = "hg38",
x = 0.5, y = 2.5, width = 4, height = 0.25,
just = c("left", "top"), default.units = "inches",
fill = "black", linecolor = "black", flip = TRUE
)
plotGenes(
chrom = chr, chromstart = start, chromend = end,
assembly = "hg38",
fontsize = 8,
x = 0.5, y = 3.05, width = 4, height = 0.5,
fontcolor = c("blue", "blue"),
fill = c("black", "black"),
strandLabels = TRUE,
stroke = 0.01,
just = c("left", "top"), default.units = "inches"
)
dev.off()
rm(list = ls())
library(grid)
library(tidyr)
library(dplyr)
library(data.table)
library(plotgardener)
library(org.Hs.eg.db)
library(TxDb.Hsapiens.UCSC.hg38.knownGene)
library(BSgenome.Hsapiens.UCSC.hg38)
#--- loci of interest - MYCN: chr2: 13071799 - 18831798
id = "G523"
chr = "chr2"
start = 13071799
end = 18831798
res = 5000
arc <- fread(paste0("/Users/cpan/Documents/ChIP/", id, "/enriched_pixels_", res, ".bedpe")) %>% dplyr::select(chr1, x1, x2, chr2, y1, y2) %>%
{colnames(.) = c("chrom1", "start1", "end1", "chrom2", "start2", "end2");.} %>%
mutate(chrom1 = paste0("chr", chrom1), chrom2 = paste0("chr", chrom2))
pdf(paste0("./outputs/", id, "_MYCN", res, ".pdf"), width = 6, height = 4) # width = 6
pageCreate(width = 5, height = 5, default.units = "inches", showGuides = F, xgrid = 0, ygrid = 0)
plotPairsArches(
data = arc,
chrom = chr, chromstart = start, chromend = end,
assembly = "hg38",
x = 0.5, y = 2.5, width = 4, height = 0.25,
just = c("left", "top"), default.units = "inches",
fill = "black", linecolor = "black", flip = TRUE
)
plotGenes(
chrom = chr, chromstart = start, chromend = end,
assembly = "hg38",
fontsize = 8,
x = 0.5, y = 3.05, width = 4, height = 0.5,
fontcolor = c("blue", "blue"),
fill = c("black", "black"),
strandLabels = TRUE,
stroke = 0.01,
just = c("left", "top"), default.units = "inches"
)
dev.off()
rm(list = ls())
library(grid)
library(tidyr)
library(dplyr)
library(data.table)
library(plotgardener)
library(org.Hs.eg.db)
library(TxDb.Hsapiens.UCSC.hg38.knownGene)
library(BSgenome.Hsapiens.UCSC.hg38)
#--- loci of interest - MYCN: chr2: 13071799 - 18831798
id = "G523"
chr = "chr2"
start = 13071799
end = 18831798
res = 5000
arc <- fread(paste0("/Users/cpan/Documents/ChIP/", id, "/enriched_pixels_", res, ".bedpe")) %>% dplyr::select(chr1, x1, x2, chr2, y1, y2) %>%
{colnames(.) = c("chrom1", "start1", "end1", "chrom2", "start2", "end2");.} %>%
mutate(chrom1 = paste0("chr", chrom1), chrom2 = paste0("chr", chrom2))
pdf(paste0("./outputs/", id, "_MYCN_", res, ".pdf"), width = 6, height = 4) # width = 6
pageCreate(width = 5, height = 5, default.units = "inches", showGuides = F, xgrid = 0, ygrid = 0)
plotPairsArches(
data = arc,
chrom = chr, chromstart = start, chromend = end,
assembly = "hg38",
x = 0.5, y = 2.5, width = 4, height = 0.25,
just = c("left", "top"), default.units = "inches",
fill = "black", linecolor = "black", flip = TRUE
)
plotGenes(
chrom = chr, chromstart = start, chromend = end,
assembly = "hg38",
fontsize = 8,
x = 0.5, y = 3.05, width = 4, height = 0.5,
fontcolor = c("blue", "blue"),
fill = c("black", "black"),
strandLabels = TRUE,
stroke = 0.01,
just = c("left", "top"), default.units = "inches"
)
dev.off()
rm(list = ls())
library(grid)
library(tidyr)
library(dplyr)
library(data.table)
library(plotgardener)
library(org.Hs.eg.db)
library(TxDb.Hsapiens.UCSC.hg38.knownGene)
library(BSgenome.Hsapiens.UCSC.hg38)
#--- loci of interest - MYCN: chr2: 13071799 - 18831798
id = "G583"
chr = "chr2"
start = 13071799
end = 18831798
res = 5000
arc <- fread(paste0("/Users/cpan/Documents/ChIP/", id, "/enriched_pixels_", res, ".bedpe")) %>% dplyr::select(chr1, x1, x2, chr2, y1, y2) %>%
{colnames(.) = c("chrom1", "start1", "end1", "chrom2", "start2", "end2");.} %>%
mutate(chrom1 = paste0("chr", chrom1), chrom2 = paste0("chr", chrom2))
pdf(paste0("./outputs/", id, "_MYCN_", res, ".pdf"), width = 6, height = 4) # width = 6
pageCreate(width = 5, height = 5, default.units = "inches", showGuides = F, xgrid = 0, ygrid = 0)
plotPairsArches(
data = arc,
chrom = chr, chromstart = start, chromend = end,
assembly = "hg38",
x = 0.5, y = 2.5, width = 4, height = 0.25,
just = c("left", "top"), default.units = "inches",
fill = "black", linecolor = "black", flip = TRUE
)
plotGenes(
chrom = chr, chromstart = start, chromend = end,
assembly = "hg38",
fontsize = 8,
x = 0.5, y = 3.05, width = 4, height = 0.5,
fontcolor = c("blue", "blue"),
fill = c("black", "black"),
strandLabels = TRUE,
stroke = 0.01,
just = c("left", "top"), default.units = "inches"
)
dev.off()
rm(list = ls())
library(grid)
library(tidyr)
library(dplyr)
library(data.table)
library(plotgardener)
library(org.Hs.eg.db)
library(TxDb.Hsapiens.UCSC.hg38.knownGene)
library(BSgenome.Hsapiens.UCSC.hg38)
#--- loci of interest - MYCN: chr2: 13071799 - 18831798
id = "G583"
chr = "chr2"
start = 13071799
end = 18831798
res = 10000
arc <- fread(paste0("/Users/cpan/Documents/ChIP/", id, "/enriched_pixels_", res, ".bedpe")) %>% dplyr::select(chr1, x1, x2, chr2, y1, y2) %>%
{colnames(.) = c("chrom1", "start1", "end1", "chrom2", "start2", "end2");.} %>%
mutate(chrom1 = paste0("chr", chrom1), chrom2 = paste0("chr", chrom2))
pdf(paste0("./outputs/", id, "_MYCN_", res, ".pdf"), width = 6, height = 4) # width = 6
pageCreate(width = 5, height = 5, default.units = "inches", showGuides = F, xgrid = 0, ygrid = 0)
plotPairsArches(
data = arc,
chrom = chr, chromstart = start, chromend = end,
assembly = "hg38",
x = 0.5, y = 2.5, width = 4, height = 0.25,
just = c("left", "top"), default.units = "inches",
fill = "black", linecolor = "black", flip = TRUE
)
plotGenes(
chrom = chr, chromstart = start, chromend = end,
assembly = "hg38",
fontsize = 8,
x = 0.5, y = 3.05, width = 4, height = 0.5,
fontcolor = c("blue", "blue"),
fill = c("black", "black"),
strandLabels = TRUE,
stroke = 0.01,
just = c("left", "top"), default.units = "inches"
)
dev.off()
rm(list = ls())
library(grid)
library(tidyr)
library(dplyr)
library(data.table)
library(plotgardener)
library(org.Hs.eg.db)
library(TxDb.Hsapiens.UCSC.hg38.knownGene)
library(BSgenome.Hsapiens.UCSC.hg38)
#--- loci of interest - MYCN: chr2: 13071799 - 18831798
id = "G523"
chr = "chr2"
start = 13071799
end = 18831798
res = 10000
arc <- fread(paste0("/Users/cpan/Documents/ChIP/", id, "/enriched_pixels_", res, ".bedpe")) %>% dplyr::select(chr1, x1, x2, chr2, y1, y2) %>%
{colnames(.) = c("chrom1", "start1", "end1", "chrom2", "start2", "end2");.} %>%
mutate(chrom1 = paste0("chr", chrom1), chrom2 = paste0("chr", chrom2))
pdf(paste0("./outputs/", id, "_MYCN_", res, ".pdf"), width = 6, height = 4) # width = 6
pageCreate(width = 5, height = 5, default.units = "inches", showGuides = F, xgrid = 0, ygrid = 0)
plotPairsArches(
data = arc,
chrom = chr, chromstart = start, chromend = end,
assembly = "hg38",
x = 0.5, y = 2.5, width = 4, height = 0.25,
just = c("left", "top"), default.units = "inches",
fill = "black", linecolor = "black", flip = TRUE
)
plotGenes(
chrom = chr, chromstart = start, chromend = end,
assembly = "hg38",
fontsize = 8,
x = 0.5, y = 3.05, width = 4, height = 0.5,
fontcolor = c("blue", "blue"),
fill = c("black", "black"),
strandLabels = TRUE,
stroke = 0.01,
just = c("left", "top"), default.units = "inches"
)
dev.off()
rm(list = ls())
#~~~ R 4.2
library(Sushi)
BiocManager::install("Sushi")
library(Sushi)
install.packages("~/Documents/Sushi_1.32.0.tar", repos = NULL)
install.packages("~/Documents/Sushi_1.32.0.tar")
library(dplyr)
library(tidyr)
library(dplyr)
library(data.table)
id="G523"
chr = "chr7"
start = 54850756
end = 55232892
loop <- fread(paste0("/Users/cpan/Documents/HiC/", id, "/enriched_pixels_5000.bedpe")) %>% as.data.frame() %>% dplyr::select(chr1, x1, x2, chr2, y1, y2) %>%
mutate(chr1 = paste0("chr", chr1)) %>% mutate(chr2 = paste0("chr", chr2)) %>% {colnames(.) = c("chrom1", "start1", "end1", "chrom2", "start2", "end2");.} %>%
mutate(dist = abs(end2- start1))
loop
View(loop)
View(loop)
rm(list = ls())
library(grid)
library(tidyr)
library(dplyr)
library(data.table)
library(plotgardener)
library(org.Hs.eg.db)
library(TxDb.Hsapiens.UCSC.hg38.knownGene)
library(BSgenome.Hsapiens.UCSC.hg38)
id = "G523"
#~~~ chr7:54850756-55232892;
chr = "chr7"
start = 54850756
end = 55232892
hic_file <- paste0("/Users/cpan/Downloads/", id, "_inter_30.hic")
contact_matrix <- straw(
norm = "NONE",    # Normalization method: "NONE", "KR", "VC", "VC_SQRT"
fname = hic_file,
"7",  "7",        # Specify chromosome(s)
unit = "BP",      # "BP" for base-pair resolution
binsize = 10000   # Bin size (must match available resolutions)
)
rm(list = ls())
#~~~ R 4.2
library(Sushi)
rm(list = ls())
#~~~ R 4.2
library(Sushi)
rm(list = ls())
#~~~ R 4.2
library(Sushi)
loop <- fread(paste0("/Users/cpan/Documents/HiC/", id, "/enriched_pixels_5000.bedpe")) %>% as.data.frame() %>% dplyr::select(chr1, x1, x2, chr2, y1, y2) %>%
mutate(chr1 = paste0("chr", chr1)) %>% mutate(chr2 = paste0("chr", chr2)) %>% {colnames(.) = c("chrom1", "start1", "end1", "chrom2", "start2", "end2");.} %>%
mutate(dist = abs(end2- start1))
library(dplyr)
library(tidyr)
library(dplyr)
library(data.table)
id="G523"
chr = "chr7"
start = 54850756
end = 55232892
loop <- fread(paste0("/Users/cpan/Documents/HiC/", id, "/enriched_pixels_5000.bedpe")) %>% as.data.frame() %>% dplyr::select(chr1, x1, x2, chr2, y1, y2) %>%
mutate(chr1 = paste0("chr", chr1)) %>% mutate(chr2 = paste0("chr", chr2)) %>% {colnames(.) = c("chrom1", "start1", "end1", "chrom2", "start2", "end2");.} %>%
mutate(dist = abs(end2- start1))
R
loop <- fread(paste0("/Users/cpan/Documents/HiC/", id, "/enriched_pixels_5000.bedpe")) %>% as.data.frame() %>% dplyr::select(chr1, x1, x2, chr2, y1, y2) %>%
mutate(chr1 = paste0("chr", chr1)) %>% mutate(chr2 = paste0("chr", chr2)) %>% {colnames(.) = c("chrom1", "start1", "end1", "chrom2", "start2", "end2");.} %>%
mutate(dist = abs(end2- start1))
library(dplyr)
library(tidyr)
library(dplyr)
library(data.table)
id="G523"
chr = "chr7"
start = 54850756
end = 55232892
loop <- fread(paste0("./inputs/enriched_pixels_5000.bedpe")) %>% as.data.frame() %>% dplyr::select(chr1, x1, x2, chr2, y1, y2) %>%
mutate(chr1 = paste0("chr", chr1)) %>% mutate(chr2 = paste0("chr", chr2)) %>% {colnames(.) = c("chrom1", "start1", "end1", "chrom2", "start2", "end2");.} %>%
mutate(dist = abs(end2- start1))
loop <- fread(paste0("./inputs/enriched_pixels_5000.bedpe"))
library(dplyr)
library(tidyr)
library(dplyr)
library(data.table)
id="G523"
chr = "chr7"
start = 54850756
end = 55232892
loop <- fread(paste0("./inputs/enriched_pixels_5000.bedpe")) %>% as.data.frame() %>% dplyr::select(chr1, x1, x2, chr2, y1, y2) %>%
mutate(chr1 = paste0("chr", chr1)) %>% mutate(chr2 = paste0("chr", chr2)) %>% {colnames(.) = c("chrom1", "start1", "end1", "chrom2", "start2", "end2");.} %>%
mutate(dist = abs(end2- start1))
library(dplyr)
library(tidyr)
library(dplyr)
library(data.table)
id="G523"
chr = "chr7"
start = 54850756
end = 55232892
loop <- fread(paste0("./inputs/enriched_pixels_5000.bedpe")) %>% as.data.frame() %>% dplyr::select(chr1, x1, x2, chr2, y1, y2) %>%
mutate(chr1 = paste0("chr", chr1)) %>% mutate(chr2 = paste0("chr", chr2)) %>% {colnames(.) = c("chrom1", "start1", "end1", "chrom2", "start2", "end2");.} %>%
mutate(dist = abs(end2- start1))
loop
plotBedpe(loop, chr, start, end, heights = loop$dist, plottype="loops", flip=TRUE)
??plotBedpe
library("devtools")
install_github("PhanstielLab/Sushi")
rm(list = ls())
#~~~ R 4.2
library(Sushi)
library(dplyr)
library(tidyr)
library(dplyr)
library(data.table)
id="G523"
chr = "chr7"
start = 54850756
end = 55232892
loop <- fread(paste0("./inputs/enriched_pixels_5000.bedpe")) %>% as.data.frame() %>% dplyr::select(chr1, x1, x2, chr2, y1, y2) %>%
mutate(chr1 = paste0("chr", chr1)) %>% mutate(chr2 = paste0("chr", chr2)) %>% {colnames(.) = c("chrom1", "start1", "end1", "chrom2", "start2", "end2");.} %>%
mutate(dist = abs(end2- start1))
mtext("distance",side=2,line=1.75,cex=.75,font=2)
plotBedpe(loop, chr, start, end, heights = loop$dist, plottype="loops", flip=TRUE)
#~~~ R 4.2
library(Sushi)
library(dplyr)
library(tidyr)
library(dplyr)
library(data.table)
id="G523"
chr = "chr7"
start = 54850756
end = 55232892
loop <- fread(paste0("./inputs/enriched_pixels_5000.bedpe")) %>% as.data.frame() %>% dplyr::select(chr1, x1, x2, chr2, y1, y2) %>%
mutate(chr1 = paste0("chr", chr1)) %>% mutate(chr2 = paste0("chr", chr2)) %>% {colnames(.) = c("chrom1", "start1", "end1", "chrom2", "start2", "end2");.} %>%
mutate(dist = abs(end2- start1))
plotBedpe(loop, chr, start, end, heights = loop$dist, plottype="loops", flip=TRUE)
packageVersion("Sushi")
rm(list = ls())
#~~~ R 4.2
library(Sushi)
library(dplyr)
library(tidyr)
library(dplyr)
library(data.table)
id="G523_L"
chr = "chr7"
start = 54850756
end = 55232892
loop <- fread(paste0("./inputs/", id, ".enriched_pixels_5000.bedpe")) %>% as.data.frame() %>% dplyr::select(chr1, x1, x2, chr2, y1, y2) %>%
mutate(chr1 = paste0("chr", chr1)) %>% mutate(chr2 = paste0("chr", chr2)) %>% {colnames(.) = c("chrom1", "start1", "end1", "chrom2", "start2", "end2");.} %>%
mutate(dist = abs(end2- start1))
plotBedpe(loop, chr, start, end, heights = loop$dist, plottype="loops", flip=TRUE)
labelgenome(chr, start, end, side = 3, n = 3, scale = "Mb")
axis(side=2,las=2,tcl=.2)
mtext("distance",side=2,line=1.75,cex=.75,font=2)
