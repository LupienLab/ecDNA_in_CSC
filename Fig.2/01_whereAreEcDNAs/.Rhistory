"%ni%" <- Negate("%in%")
id = "A7TK_T"
#~~~ input cell types
nth = 1
ecDNA_malign_cell_1 <- read.table(paste0(id, ".outputs/", id, "-", nth, "_ecDNA_positive_malign_cell.txt"), header = F, stringsAsFactors = F) %>% {colnames(.) = "barcode";.} %>% pull("barcode")
nth = 2
ecDNA_malign_cell_2 <- read.table(paste0(id, ".outputs/", id, "-", nth, "_ecDNA_positive_malign_cell.txt"), header = F, stringsAsFactors = F) %>% {colnames(.) = "barcode";.} %>% pull("barcode")
overlap_ecDNA_positive_malign_cell <- intersect(ecDNA_malign_cell_1, ecDNA_malign_cell_2)
venn.plot <- venn.diagram(
x = list(A7TK_T_1 = ecDNA_malign_cell_1, A7TK_T_2 = ecDNA_malign_cell_2),
filename = NULL,
fill = "white",
alpha = 1,
cex = 2,
cat.cex = 1.5
)
grid::grid.draw(venn.plot)
rm(list = ls())
library(dplyr)
library(ggplot2)
library(data.table)
library(Vennerable)
library(VennDiagram)
"%ni%" <- Negate("%in%")
#~~~ inputs
id = "A7TK_T"
nth = 1
ecDNA_malign_cell_1 <- read.table(paste0(id, ".outputs/", id, "-", nth, "_ecDNA_positive_malign_cell.txt"), header = F, stringsAsFactors = F) %>% {colnames(.) = "barcode";.} %>% pull("barcode")
nth = 2
ecDNA_malign_cell_2 <- read.table(paste0(id, ".outputs/", id, "-", nth, "_ecDNA_positive_malign_cell.txt"), header = F, stringsAsFactors = F) %>% {colnames(.) = "barcode";.} %>% pull("barcode")
overlap_ecDNA_positive_malign_cell <- intersect(ecDNA_malign_cell_1, ecDNA_malign_cell_2)
venn_plot <- venn.diagram(
x = list(A7TK_T_1 = ecDNA_malign_cell_1, A7TK_T_2 = ecDNA_malign_cell_2),
filename = NULL,
fill = "white",
alpha = 1,
cex = 2,
cat.cex = 1.5
)
grid::grid.draw(venn_plot)
# install.packages("ggVennDiagram")  # once
library(ggVennDiagram)
# install.packages("eulerr")  # once
library(eulerr)
fit <- euler(list(A = sets$A, B = sets$B, C = sets$C))
# install.packages("ggVennDiagram")  # onc
# your sets as a named list
sets <- list(
A = c("g1","g2","g3","g4"),
B = c("g3","g4","g5"),
C = c("g2","g6")
)
p <- ggVennDiagram(sets, label_alpha = 0) +
scale_fill_gradient(low = "white", high = "#4DBBD5") +
theme_void() + theme(legend.position = "none")
# install.packages("eulerr")  # once
library(eulerr)
fit <- euler(list(A = sets$A, B = sets$B, C = sets$C))
plot(fit, quantities = TRUE, labels = TRUE)
install.packages("ggVennDiagram")
# install.packages("ggVennDiagram")  # once
library(ggVennDiagram)
# your sets as a named list
sets <- list(
A = c("g1","g2","g3","g4"),
B = c("g3","g4","g5"),
C = c("g2","g6")
)
p <- ggVennDiagram(sets, label_alpha = 0) +
scale_fill_gradient(low = "white", high = "#4DBBD5") +
theme_void() + theme(legend.position = "none")
p
# Save (publication quality PDF)
ggplot2::ggsave("venn3.pdf", p, width = 4, height = 4, device = cairo_pdf)
#~~~~~~~~~~~
id = "G933_T"
n = 1
ecDNA_malign_cell_1 <- read.table(paste0(id, ".outputs/", id, "-", n, "_ecDNA_positive_malign_cell.txt"), header = F, stringsAsFactors = F) %>% {colnames(.) = "barcode";.} %>% pull("barcode")
n = 2
ecDNA_malign_cell_2 <- read.table(paste0(id, ".outputs/", id, "-", n, "_ecDNA_positive_malign_cell.txt"), header = F, stringsAsFactors = F) %>% {colnames(.) = "barcode";.} %>% pull("barcode")
n = 3
ecDNA_malign_cell_3 <- read.table(paste0(id, ".outputs/", id, "-", n, "_ecDNA_positive_malign_cell.txt"), header = F, stringsAsFactors = F) %>% {colnames(.) = "barcode";.} %>% pull("barcode")
# hits
length(intersect(ecDNA_malign_cell_1, ecDNA_malign_cell_2))
length(intersect(ecDNA_malign_cell_1, ecDNA_malign_cell_3))
length(intersect(ecDNA_malign_cell_2, ecDNA_malign_cell_3))
venn_plot <- venn.diagram(
x = list(G933_T_1 = ecDNA_malign_cell_1, G933_T_2 = ecDNA_malign_cell_2, G933_T_3 = ecDNA_malign_cell_3),
filename = NULL,
fill = "white",
alpha = 0.5,
cex = 2,
cat.cex = 1.5
)
grid::grid.draw(venn_plot)
grid::grid.draw(venn_plot)
rm(list = ls())
library(dplyr)
library(ggplot2)
library(data.table)
library(Vennerable)
library(VennDiagram)
"%ni%" <- Negate("%in%")
#~~~ inputs
id = "A7TK_T"
nth = 1
ecDNA_malign_cell_1 <- read.table(paste0(id, ".outputs/", id, "-", nth, "_ecDNA_positive_malign_cell.txt"), header = F, stringsAsFactors = F) %>% {colnames(.) = "barcode";.} %>% pull("barcode")
nth = 2
ecDNA_malign_cell_2 <- read.table(paste0(id, ".outputs/", id, "-", nth, "_ecDNA_positive_malign_cell.txt"), header = F, stringsAsFactors = F) %>% {colnames(.) = "barcode";.} %>% pull("barcode")
overlap_ecDNA_positive_malign_cell <- intersect(ecDNA_malign_cell_1, ecDNA_malign_cell_2)
venn_plot <- venn.diagram(
x = list(A7TK_T_1 = ecDNA_malign_cell_1, A7TK_T_2 = ecDNA_malign_cell_2),
filename = NULL,
fill = "white",
alpha = 1,
cex = 2,
cat.cex = 1.5
)
grid::grid.draw(venn_plot)
rm(list = ls())
library(dplyr)
library(ggplot2)
library(data.table)
library(Vennerable)
library(VennDiagram)
"%ni%" <- Negate("%in%")
#~~~ inputs
id = "A7TK_T"
nth = 1
ecDNA_malign_cell_1 <- read.table(paste0(id, ".outputs/", id, "-", nth, "_ecDNA_positive_malign_cell.txt"), header = F, stringsAsFactors = F) %>% {colnames(.) = "barcode";.} %>% pull("barcode")
nth = 2
ecDNA_malign_cell_2 <- read.table(paste0(id, ".outputs/", id, "-", nth, "_ecDNA_positive_malign_cell.txt"), header = F, stringsAsFactors = F) %>% {colnames(.) = "barcode";.} %>% pull("barcode")
hit12 <- intersect(ecDNA_malign_cell_1, ecDNA_malign_cell_2)
length(hit12)
#~~~~~~~~~~~
id = "G933_T"
n = 1
ecDNA_malign_cell_1 <- read.table(paste0(id, ".outputs/", id, "-", n, "_ecDNA_positive_malign_cell.txt"), header = F, stringsAsFactors = F) %>% {colnames(.) = "barcode";.} %>% pull("barcode")
n = 2
ecDNA_malign_cell_2 <- read.table(paste0(id, ".outputs/", id, "-", n, "_ecDNA_positive_malign_cell.txt"), header = F, stringsAsFactors = F) %>% {colnames(.) = "barcode";.} %>% pull("barcode")
n = 3
ecDNA_malign_cell_3 <- read.table(paste0(id, ".outputs/", id, "-", n, "_ecDNA_positive_malign_cell.txt"), header = F, stringsAsFactors = F) %>% {colnames(.) = "barcode";.} %>% pull("barcode")
# hits
hit_12 <- length(intersect(ecDNA_malign_cell_1, ecDNA_malign_cell_2))
hit_13 <- length(intersect(ecDNA_malign_cell_1, ecDNA_malign_cell_3))
hit_23 <- length(intersect(ecDNA_malign_cell_2, ecDNA_malign_cell_3))
length(hit_12)
hit_12
hit_13
hit_23
3764+51
3764+150
3764+84
#~~~~~~~~~~~
id = "G933_T"
n = 1
ecDNA_malign_cell_1 <- read.table(paste0(id, ".outputs/", id, "-", n, "_ecDNA_positive_malign_cell.txt"), header = F, stringsAsFactors = F) %>% {colnames(.) = "barcode";.} %>% pull("barcode")
n = 2
ecDNA_malign_cell_2 <- read.table(paste0(id, ".outputs/", id, "-", n, "_ecDNA_positive_malign_cell.txt"), header = F, stringsAsFactors = F) %>% {colnames(.) = "barcode";.} %>% pull("barcode")
n = 3
ecDNA_malign_cell_3 <- read.table(paste0(id, ".outputs/", id, "-", n, "_ecDNA_positive_malign_cell.txt"), header = F, stringsAsFactors = F) %>% {colnames(.) = "barcode";.} %>% pull("barcode")
# hits
hit_12 <- length(intersect(ecDNA_malign_cell_1, ecDNA_malign_cell_2))
hit_13 <- length(intersect(ecDNA_malign_cell_1, ecDNA_malign_cell_3))
hit_23 <- length(intersect(ecDNA_malign_cell_2, ecDNA_malign_cell_3))
hit_123 <- length(intersect(intersect(ecDNA_malign_cell_1, ecDNA_malign_cell_2), ecDNA_malign_cell_3))
hit_12
hit_123
rm(list = ls())
sample <- "G946_T"
nth <- 1
readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
rm(list = ls())
sample <- "G946_T"
nth <- 1
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
obj
class(obj)
obj
slotNames(obj)
attr(obj, "cellColData")
rm(list = ls())
sample <- "G946_T"
nth <- 1
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
class(cell_df)
rm(list = ls())
sample <- "G946_T"
nth <- 1
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
cell_df <- as.data.frame(cell_df)
View(obj)
View(cell_df)
View(cell_df)
head(cell_df)
rm(list = ls())
library(dplyr)
library(data.table)
sample <- "G946_T"
nth <- 1
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
cell_df <- as.data.frame(cell_df) %>% mutate(species = paste0(sample, "-", nth))
cell_df
rm(list = ls())
library(dplyr)
library(tibble)
library(data.table)
sample <- "G946_T"
nth <- 1
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
cell_df <- as.data.frame(cell_df) %>% mutate(species = paste0(sample, "-", nth)) %>% rownames_to_column(var = "cellbarcode")
View(cell_df)
head(cell_df)
rm(list = ls())
library(dplyr)
library(tibble)
library(data.table)
sample <- "G946_T"
nth <- 1
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
cell_df <- as.data.frame(cell_df) %>% mutate(species = paste0(sample, "-", nth)) %>% rownames_to_column(var = "cellbarcode") %>%
dplyr::select(cellbarcode, species, ecDNAcontent celltype)
View(cell_df)
rm(list = ls())
library(dplyr)
library(tibble)
library(data.table)
sample <- "G946_T"
nth <- 1
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
cell_df <- as.data.frame(cell_df) %>% mutate(species = paste0(sample, "-", nth)) %>% rownames_to_column(var = "cellbarcode") %>%
dplyr::select(cellbarcode, species, ecDNAcontent, celltype)
View(cell_df)
rm(list = ls())
library(dplyr)
library(tibble)
library(data.table)
sample <- "G946_T"
nth <- 1
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
cell_df <- as.data.frame(cell_df) %>% mutate(species = paste0(sample, "-", nth)) %>% rownames_to_column(var = "cellbarcode") %>%
dplyr::select(cellbarcode, species, ecDNAcontent, celltype)
write.table(cell_df, file = paste0(sample, ".outputs", "/", sample, "-", nth, "_ecDNA_content.txt"), row.names = F, col.names = T, sep = "\t", quote = F)
malign_cell <- read.table(paste0("/Users/chupan/Documents/data_su2c/scATAC/maligncell/", id, ".maligncell.txt"), header = F, stringsAsFactors = F) %>% {colnames(.) = "barcode";.} %>% pull(barcode)
rm(list = ls())
library(dplyr)
library(tibble)
library(data.table)
sample <- "G946_T"
nth <- 1
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
cell_df <- as.data.frame(cell_df) %>% mutate(species = paste0(sample, "-", nth)) %>% rownames_to_column(var = "cellbarcode") %>%
dplyr::select(cellbarcode, species, ecDNAcontent, celltype)
malign_cell <- read.table(paste0("/Users/chupan/Documents/data_su2c/scATAC/maligncell/", id, ".maligncell.txt"), header = F, stringsAsFactors = F) %>% {colnames(.) = "barcode";.} %>% pull(barcode)
rm(list = ls())
library(dplyr)
library(tibble)
library(data.table)
sample <- "G946_T"
nth <- 1
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
cell_df <- as.data.frame(cell_df) %>% mutate(species = paste0(sample, "-", nth)) %>% rownames_to_column(var = "cellbarcode") %>%
dplyr::select(cellbarcode, species, ecDNAcontent, celltype)
malign_cell <- read.table(paste0("/Users/chupan/Documents/data_su2c/scATAC/maligncell/", sample, ".maligncell.txt"), header = F, stringsAsFactors = F) %>% {colnames(.) = "barcode";.} %>% pull(barcode)
head(malign_cell)
rm(list = ls())
library(dplyr)
library(tibble)
library(data.table)
sample <- "G946_T"
nth <- 1
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
cell_df <- as.data.frame(cell_df) %>% mutate(species = paste0(sample, "-", nth)) %>% rownames_to_column(var = "cellbarcode") %>%
dplyr::select(cellbarcode, species, ecDNAcontent, celltype)
malign_cell <- read.table(paste0("/Users/chupan/Documents/data_su2c/scATAC/maligncell/", sample, ".maligncell.txt"), header = F, stringsAsFactors = F) %>% {colnames(.) = "barcode";.}
head(malign_cell)
head
head(cell_df)
rm(list = ls())
library(dplyr)
library(tibble)
library(data.table)
sample <- "G946_T"
nth <- 1
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
cell_df <- as.data.frame(cell_df) %>% mutate(species = paste0(sample, "-", nth)) %>% rownames_to_column(var = "cellbarcode") %>%
dplyr::select(cellbarcode, species, ecDNAcontent, celltype)
malign_cell <- read.table(paste0("/Users/chupan/Documents/data_su2c/scATAC/maligncell/", sample, ".maligncell.txt"), header = F, stringsAsFactors = F) %>%
{colnames(.) = "cellbarcode";.} %>% mutate(cellbarcode = paste0(sample, "#", cellbarcode))
head(malign_cell)
head(cell_df)
rm(list = ls())
library(dplyr)
library(tibble)
library(data.table)
sample <- "G946_T"
nth <- 1
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
cell_df <- as.data.frame(cell_df) %>% mutate(species = paste0(sample, "-", nth)) %>% rownames_to_column(var = "barcode") %>%
dplyr::select(cellbarcode, species, ecDNAcontent, celltype)
rm(list = ls())
library(dplyr)
library(tibble)
library(data.table)
sample <- "G946_T"
nth <- 1
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
cell_df <- as.data.frame(cell_df) %>% mutate(species = paste0(sample, "-", nth)) %>% rownames_to_column(var = "barcode") %>%
dplyr::select(barcode, species, ecDNAcontent, celltype)
malign_cell <- read.table(paste0("/Users/chupan/Documents/data_su2c/scATAC/maligncell/", sample, ".maligncell.txt"), header = F, stringsAsFactors = F) %>%
{colnames(.) = "barcode";.} %>% mutate(barcode = paste0(sample, "#", barcode))
head(cell_df)
head(malign_cell)
dim(cell_df)
dim(malign_cell)
rm(list = ls())
library(dplyr)
library(tibble)
library(data.table)
sample <- "G946_T"
nth <- 1
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
cell_df <- as.data.frame(cell_df) %>% mutate(species = paste0(sample, "-", nth)) %>% rownames_to_column(var = "barcode") %>%
dplyr::select(barcode, species, ecDNAcontent, celltype)
malign_cell <- read.table(paste0("/Users/chupan/Documents/data_su2c/scATAC/maligncell/", sample, ".maligncell.txt"), header = F, stringsAsFactors = F) %>%
{colnames(.) = "barcode";.} %>% mutate(barcode = paste0(sample, "#", barcode))
cell_df <- dplyr::left_join(malign_cell, by = "barcode")
rm(list = ls())
library(dplyr)
library(tibble)
library(data.table)
sample <- "G946_T"
nth <- 1
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
cell_df <- as.data.frame(cell_df) %>% mutate(species = paste0(sample, "-", nth)) %>% rownames_to_column(var = "barcode") %>%
dplyr::select(barcode, species, ecDNAcontent, celltype)
malign_cell <- read.table(paste0("/Users/chupan/Documents/data_su2c/scATAC/maligncell/", sample, ".maligncell.txt"), header = F, stringsAsFactors = F) %>%
{colnames(.) = "barcode";.} %>% mutate(barcode = paste0(sample, "#", barcode))
cell_df <- cell_df %>% dplyr::left_join(malign_cell, by = "barcode")
head(cell_df)
rm(list = ls())
library(dplyr)
library(tibble)
library(data.table)
sample <- "G946_T"
nth <- 1
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
cell_df <- as.data.frame(cell_df) %>% mutate(species = paste0(sample, "-", nth)) %>% rownames_to_column(var = "barcode") %>%
dplyr::select(barcode, species, ecDNAcontent, celltype)
malign_cell <- read.table(paste0("/Users/chupan/Documents/data_su2c/scATAC/maligncell/", sample, ".maligncell.txt"), header = F, stringsAsFactors = F) %>%
{colnames(.) = "barcode";.} %>% mutate(barcode = paste0(sample, "#", barcode))
head(cell_df)
head(malign_cell)
rm(list = ls())
library(dplyr)
library(tibble)
library(data.table)
sample <- "G946_T"
nth <- 1
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
cell_df <- as.data.frame(cell_df) %>% mutate(species = paste0(sample, "-", nth)) %>% rownames_to_column(var = "barcode") %>%
dplyr::select(barcode, species, ecDNAcontent, celltype)
malign_cell <- read.table(paste0("/Users/chupan/Documents/data_su2c/scATAC/maligncell/", sample, ".maligncell.txt"), header = F, stringsAsFactors = F) %>%
{colnames(.) = "barcode";.} %>% mutate(barcode = paste0(sample, "#", barcode))
cell_df <- cell_df %>% mutate(malignancy = if_else(barcode %in% malign_cell$barcode), "malignant", "non-malignant")
rm(list = ls())
library(dplyr)
library(tibble)
library(data.table)
sample <- "G946_T"
nth <- 1
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
cell_df <- as.data.frame(cell_df) %>% mutate(species = paste0(sample, "-", nth)) %>% rownames_to_column(var = "barcode") %>%
dplyr::select(barcode, species, ecDNAcontent, celltype)
malign_cell <- read.table(paste0("/Users/chupan/Documents/data_su2c/scATAC/maligncell/", sample, ".maligncell.txt"), header = F, stringsAsFactors = F) %>%
{colnames(.) = "barcode";.} %>% mutate(barcode = paste0(sample, "#", barcode))
cell_df <- cell_df %>% mutate(malignancy = if_else(barcode %in% malign_cell$barcode, "malignant", "non-malignant"))
View(cell_df)
table(cell_df$celltype)
table(cell_df$malignancy)
table(cell_df$celltype, cell_df$malignancy)
dim(cell_df)
rm(list = ls())
library(dplyr)
library(tibble)
library(data.table)
sample <- "G946_T"
nth <- 1
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
cell_df <- as.data.frame(cell_df) %>% mutate(species = paste0(sample, "-", nth)) %>% rownames_to_column(var = "barcode") %>%
dplyr::select(barcode, species, ecDNAcontent, celltype)
malign_cell <- read.table(paste0("/Users/chupan/Documents/data_su2c/scATAC/maligncell/", sample, ".maligncell.txt"), header = F, stringsAsFactors = F) %>%
{colnames(.) = "barcode";.} %>% mutate(barcode = paste0(sample, "#", barcode))
cell_df <- cell_df %>% mutate(malignancy = if_else(barcode %in% malign_cell$barcode, "malignant", "normal"))
cell_df
rm(list = ls())
library(dplyr)
library(tibble)
library(data.table)
sample <- "G946_T"
nth <- 1
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
cell_df <- as.data.frame(cell_df) %>% mutate(species = paste0(sample, "-", nth)) %>% rownames_to_column(var = "barcode") %>%
dplyr::select(barcode, species, ecDNAcontent, celltype)
malign_cell <- read.table(paste0("/Users/chupan/Documents/data_su2c/scATAC/maligncell/", sample, ".maligncell.txt"), header = F, stringsAsFactors = F) %>%
{colnames(.) = "barcode";.} %>% mutate(barcode = paste0(sample, "#", barcode))
cell_df <- cell_df %>% mutate(malignancy = if_else(barcode %in% malign_cell$barcode, "malignant", "normal"))
write.table(cell_df, file = paste0(sample, "-", nth, "_cell_info.txt"), row.names = F, col.names = T, sep = "\t", quote = F)
rm(list = ls())
library(dplyr)
library(tibble)
library(data.table)
sample <- "G958_T"
nth <- 1
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
cell_df <- as.data.frame(cell_df) %>% mutate(species = paste0(sample, "-", nth)) %>% rownames_to_column(var = "barcode") %>%
dplyr::select(barcode, species, ecDNAcontent, celltype)
malign_cell <- read.table(paste0("/Users/chupan/Documents/data_su2c/scATAC/maligncell/", sample, ".maligncell.txt"), header = F, stringsAsFactors = F) %>%
{colnames(.) = "barcode";.} %>% mutate(barcode = paste0(sample, "#", barcode))
cell_df <- cell_df %>% mutate(malignancy = if_else(barcode %in% malign_cell$barcode, "malignant", "normal"))
write.table(cell_df, file = paste0(sample, "-", nth, "_cell_info.txt"), row.names = F, col.names = T, sep = "\t", quote = F)
rm(list = ls())
library(dplyr)
library(tibble)
library(data.table)
sample <- "G933_T"
nth <- 1
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
cell_df <- as.data.frame(cell_df) %>% mutate(species = paste0(sample, "-", nth)) %>% rownames_to_column(var = "barcode") %>%
dplyr::select(barcode, species, ecDNAcontent, celltype)
malign_cell <- read.table(paste0("/Users/chupan/Documents/data_su2c/scATAC/maligncell/", sample, ".maligncell.txt"), header = F, stringsAsFactors = F) %>%
{colnames(.) = "barcode";.} %>% mutate(barcode = paste0(sample, "#", barcode))
cell_df <- cell_df %>% mutate(malignancy = if_else(barcode %in% malign_cell$barcode, "malignant", "normal"))
write.table(cell_df, file = paste0(sample, "-", nth, "_cell_info.txt"), row.names = F, col.names = T, sep = "\t", quote = F)
rm(list = ls())
library(dplyr)
library(tibble)
library(data.table)
sample <- "G933_T"
nth <- 2
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
cell_df <- as.data.frame(cell_df) %>% mutate(species = paste0(sample, "-", nth)) %>% rownames_to_column(var = "barcode") %>%
dplyr::select(barcode, species, ecDNAcontent, celltype)
malign_cell <- read.table(paste0("/Users/chupan/Documents/data_su2c/scATAC/maligncell/", sample, ".maligncell.txt"), header = F, stringsAsFactors = F) %>%
{colnames(.) = "barcode";.} %>% mutate(barcode = paste0(sample, "#", barcode))
cell_df <- cell_df %>% mutate(malignancy = if_else(barcode %in% malign_cell$barcode, "malignant", "normal"))
write.table(cell_df, file = paste0(sample, "-", nth, "_cell_info.txt"), row.names = F, col.names = T, sep = "\t", quote = F)
rm(list = ls())
library(dplyr)
library(tibble)
library(data.table)
sample <- "G933_T"
nth <- 3
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
cell_df <- as.data.frame(cell_df) %>% mutate(species = paste0(sample, "-", nth)) %>% rownames_to_column(var = "barcode") %>%
dplyr::select(barcode, species, ecDNAcontent, celltype)
malign_cell <- read.table(paste0("/Users/chupan/Documents/data_su2c/scATAC/maligncell/", sample, ".maligncell.txt"), header = F, stringsAsFactors = F) %>%
{colnames(.) = "barcode";.} %>% mutate(barcode = paste0(sample, "#", barcode))
cell_df <- cell_df %>% mutate(malignancy = if_else(barcode %in% malign_cell$barcode, "malignant", "normal"))
write.table(cell_df, file = paste0(sample, "-", nth, "_cell_info.txt"), row.names = F, col.names = T, sep = "\t", quote = F)
rm(list = ls())
library(dplyr)
library(tibble)
library(data.table)
sample <- "A7TK_T"
nth <- 2
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
cell_df <- as.data.frame(cell_df) %>% mutate(species = paste0(sample, "-", nth)) %>% rownames_to_column(var = "barcode") %>%
dplyr::select(barcode, species, ecDNAcontent, celltype)
malign_cell <- read.table(paste0("/Users/chupan/Documents/data_su2c/scATAC/maligncell/", sample, ".maligncell.txt"), header = F, stringsAsFactors = F) %>%
{colnames(.) = "barcode";.} %>% mutate(barcode = paste0(sample, "#", barcode))
cell_df <- cell_df %>% mutate(malignancy = if_else(barcode %in% malign_cell$barcode, "malignant", "normal"))
write.table(cell_df, file = paste0(sample, "-", nth, "_cell_info.txt"), row.names = F, col.names = T, sep = "\t", quote = F)
rm(list = ls())
library(dplyr)
library(tibble)
library(data.table)
sample <- "A7TK_T"
nth <- 1
obj <- readRDS(file = paste0(sample, ".outputs", "/", sample, "-", nth, ".obj.rds"))
cell_df <- attr(obj, "cellColData")
cell_df <- as.data.frame(cell_df) %>% mutate(species = paste0(sample, "-", nth)) %>% rownames_to_column(var = "barcode") %>%
dplyr::select(barcode, species, ecDNAcontent, celltype)
malign_cell <- read.table(paste0("/Users/chupan/Documents/data_su2c/scATAC/maligncell/", sample, ".maligncell.txt"), header = F, stringsAsFactors = F) %>%
{colnames(.) = "barcode";.} %>% mutate(barcode = paste0(sample, "#", barcode))
cell_df <- cell_df %>% mutate(malignancy = if_else(barcode %in% malign_cell$barcode, "malignant", "normal"))
write.table(cell_df, file = paste0(sample, "-", nth, "_cell_info.txt"), row.names = F, col.names = T, sep = "\t", quote = F)
